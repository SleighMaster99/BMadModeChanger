
## 모드 변경(Shift+Tab) 후 에이전트 자동 복원 (BMad Mode Changer)

> 이 섹션은 BMad Mode Changer에 의해 추가되었습니다.
> 설치: `npx bmad-mode-changer install`

**중요**: 이 규칙은 **동일한 세션 내에서 Shift+Tab으로 모드를 변경한 직후에만** 적용됩니다.
- 새로운 세션 시작 시에는 자동 복원을 수행하지 마세요.
- 사용자가 `/BMad:agents:*` 명령어를 직접 입력한 경우에도 복원 메시지를 표시하지 마세요.

### 자동 복원 조건
다음 조건이 **모두** 충족될 때만 에이전트를 복원하세요:
1. 현재 세션에서 이미 BMad 에이전트가 활성화된 적이 있음 (대화 기록에서 확인 가능)
2. Shift+Tab으로 모드가 변경됨 (plan mode, auto mode 등으로 전환)
3. 모드 변경 후 첫 번째 사용자 메시지

### 복원 절차
1. **상태 파일 확인**: `.claude/.agent-context.json` 파일의 `activeAgent` 값 확인
2. **에이전트 복원**: 해당 에이전트를 **사용자에게 묻지 않고** 즉시 재활성화
3. **복원 알림**:
   ```
   [모드 변경 후 자동 복원] BMad {에이전트명} 에이전트가 재활성화되었습니다.
   ```

### 복원하지 않는 경우
- **새 세션 시작**: 대화 기록이 없거나 BMad 에이전트 활성화 기록이 없으면 복원하지 않음
- **사용자 직접 활성화**: 사용자가 `/BMad:agents:*` 명령어를 입력한 경우 중복 복원하지 않음

> **참고**: Hook 시스템이 `/BMad:agents:*` 명령어 실행 시 자동으로 에이전트 상태를 `.claude/.agent-context.json`에 저장합니다.
